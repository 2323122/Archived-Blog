---
title: 字符串Hash 学习报告
date: 2019-02-14 17:38:10
categories: 学习报告
tags: 
    - 字符串
    - Hash
top:
toc: true
---
听julao xht的建议学了字符串哈希。
<!--more-->

先挂一张图：

![](https://i.loli.net/2019/02/14/5c6537a8a0050.jpg)

图源：xht 拍自**《进阶指南》**

# 简介

## 意义

如书中所说，字符串hash可以将**任何字符串**映射成一个**非负整数**的值，从而方便进行比较。

## hash冲突

指两个或多个不同的字符串被映射到同一个**非负整数**的情况。

# 流程

## 如何求给定串的Hash值

首先选取一个**固定值P**（最好是质数），我们可以把字符串看成一个**P进制数**，以此映射到一个非负整数的值上。

接着选取一个**固定模数M**，将上述**P进制数模M意义下的值**作为**原字符串**的Hash值。

通常，我们选取$2^{64}$作为模数，这样就可以使用**unsigned long long 类型**来储存原P进制数，在大于模数M时自动溢出，可**避免低效取模运算**。

## 如何处理hash冲突

**任何数据都无法避免Hash冲突**

我们可以做的，只是尽可能减少冲突概率。

有以下几种做法：

### 在模数上

对于P，我们可以选用**P=131**或**P=13331**。~~对于M，我们可以选用19260817~~

### 其他做法

可以进行多组Hash，使用一个**多元组**储存不同hash的结果，在比对时逐次比对，可以**有效降低**Hash冲突。

## 对应字符串的操作

设$F[s]$储存字符串$s$的Hash值，那么对于一个新串$t$，我们有

$${F[t]=(F[s+t]-F[s]*P^{strlen(t)})}$$

对应到P进制数上，就相当于**左移操作**。

当$t$为一个字符${c}$时，我们可以得到字符串Hash值的初始化公式：

$${F[s+c]=F[s]+p\times value[c]}$$

一般$value[c]$取$ASCII$码中字符c的对应值。

# 例题

~~[Luogu P3370 【模板】字符串哈希](https://www.luogu.org/problemnew/show/P3370)~~(这题${Set}$和${Map}$可以水过)

[CH1401 兔子与兔子](http://contest-hunter.org:83/contest/0x10%E3%80%8C%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%8D%E4%BE%8B%E9%A2%98/1401%20%E5%85%94%E5%AD%90%E4%B8%8E%E5%85%94%E5%AD%90)

