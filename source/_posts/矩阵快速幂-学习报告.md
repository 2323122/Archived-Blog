---
title: çŸ©é˜µå¿«é€Ÿå¹‚ å­¦ä¹ æŠ¥å‘Š
categories: å­¦ä¹ æŠ¥å‘Š
date: 2019-03-05 16:20:09
tags: 
    - é€’æ¨
    - çŸ©é˜µå¿«é€Ÿå¹‚
top:
toc: true
---

# çŸ©é˜µçš„å­˜å‚¨

ä¸ºæ–¹ä¾¿ç¼–å†™å‡½æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª**ç»“æ„ä½“**`Mat`æ¥å­˜å‚¨ä¸€ä¸ªçŸ©é˜µã€‚

åŒæ—¶å¯ä»¥æ„é€ å‡½æ•°ä½¿çŸ©é˜µå…ƒç´ çš„åˆå§‹å€¼ä¸º0ã€‚

```c++
struct mat {
    int m[N][N];//Nè§†æƒ…å†µè€Œå®š
    mat(){memset(m,0,sizeof(m));}
}
```

<!--more-->

# çŸ©é˜µä¹˜æ³•

## å®šä¹‰

å¯¹äºå¤§å°ä¸º$n\times m$çš„çŸ©é˜µ$A$å’Œå¤§å°ä¸º$n\times k$çš„çŸ©é˜µ$B$ï¼Œè§„å®š$C=A\times B$ï¼Œå…¶ä¸­ï¼š
$$C_{i,j}=\sum\limits_{k=1}^{n}A_{i,p}*B_{p,j}$$

## ä»£ç å®ç°

```c++
mat mul(mat a, mat b) {
    mat ans;
    for(register int i = 1 ; i <= n ; i++) {
        for(register int j = 1 ; j <= n ; j++) {
            for(register int k = 1 ; k <= n ; k++) {
                ans.m[i][j] += a.m[i][k] * b.m[k][j];
            }
        }
    }
    return ans;
}
```

# æ™®é€šå¿«é€Ÿå¹‚

è¿™é‡Œåªç»™å‡ºå®ç°ã€‚

```c++
int power(int a, int b) {
    int ans = 1;//ä¸€å®šè¦è®°ä½åˆå§‹å€¼ä¸º1
    while(b) {
        if(b&1) ans = ans * a;
        a*=a;
        b>>=1;
    }
    return ans;
}
```

# çŸ©é˜µå¿«é€Ÿå¹‚

## æ„ä¹‰

å¸¸ç”¨äº**åŠ é€Ÿé€’æ¨**ã€‚

## å®ç°

æˆ‘ä»¬ç»“åˆæ™®é€šå¿«é€Ÿå¹‚çš„æ€æƒ³ï¼Œå°†å…ƒç´ æ¢ä¸ºçŸ©é˜µï¼Œä¸éš¾å¾—åˆ°ä¸‹é¢çš„ä»£ç ï¼š

```c
mat power(mat a, int b) {
    mat ans;//è¿™é‡Œçš„anså·²ç»åˆå§‹åŒ–ï¼Œå…·ä½“çœ‹ä¸‹æ–‡
    while(b) {
        if(b&1) ans = mul(ans, a);
        a = mul(a, a);
        b>>=1;
    }
    return ans;
}
```

### çœ‹åˆ°ä»£ç é‡Œçš„æ³¨é‡Šäº†ğŸ?

çŸ©é˜µ$ans$åŒæ ·æ˜¯è¦åˆå§‹åŒ–çš„ï¼Œä¸åŒäºæ™®é€šå¿«é€Ÿå¹‚ï¼Œè¿™é‡Œçš„$ans$åº”åˆå§‹åŒ–ä¸º**å•ä½çŸ©é˜µ**ã€‚~~ï¼ˆä¸çŸ¥é“æ˜¯å•¥çš„ï¼Œç™¾åº¦å»å§ï¼‰~~~~(åº”è¯¥æ²¡äººä¸çŸ¥é“å§...)~~

```c++
for(register int i = 1 ; i <= n ; i++) {
    ans.m[i][i] = 1;
}
```

æˆ‘ä»¬å¾€å¾€æŠŠå®ƒå°è£…åœ¨`init()`é‡Œé¢ï¼Œå› ä¸ºåœ¨æ•°åˆ—é€’æ¨é—®é¢˜ä¸­ï¼Œè¦åˆå§‹åŒ–çš„è¿˜æœ‰$base$çŸ©é˜µã€‚

# ä¸åŒçš„å†™æ³•

~~ï¼ˆæ‰“`mul()`å¤ªç´¯äº†ï¼Ÿï¼‰~~ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨ç»“æ„ä½“å†…é‡è½½`*`~~å’Œ*=~~è¿ç®—ç¬¦ã€‚æ²¡ä»€ä¹ˆå¤§çš„åŒºåˆ«ã€‚

```c++
struct mat {
    int m[N][N];
    mat(){memset(m,0,sizeof(m));}
    mat operator * (const mat &a) const {
        mat ans;
        for(register int i = 1 ; i <= n ; i++) {
            for(register int j = 1 ; j <= n ; j++) {
                for(register int k = 1 ; k <= n ; k++) {
                    ans.m[i][j] += m[i][k] * a.m[k][j];
                }
            }
        }
        return ans;
    }
}
```

é‚£ä¹ˆï¼Œå¿«é€Ÿå¹‚ä¸­çš„`mul()`å°±è¦æ¢æˆ`*`ã€‚

# å…³äºæ•°åˆ—åŠ é€Ÿé€’æ¨

## æ„é€ çŸ©é˜µ

~~æˆ‘è®²ä¸æ¥æ€ä¹ˆæ„é€ ~~

ä¸ºäº†ä½¿ç”¨çŸ©é˜µå¿«é€Ÿå¹‚ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªçŸ©é˜µ`base`ï¼Œä½¿å¾—æ¯**ä¹˜**ä¸€æ¬¡`base`ï¼Œå°±å¯ä»¥å¾—åˆ°æ•°åˆ—çš„ä¸‹ä¸€é¡¹ã€‚

## éœ€è¦æ³¨æ„

æˆ‘ä»¬åœ¨çŸ©é˜µå¿«é€Ÿå¹‚çš„æ—¶å€™ï¼ŒæŒ‡æ•°çš„å€¼åº”å½“æ˜¯`n-2`è€Œä¸æ˜¯`n`ã€‚

## å¿«åœ¨å“ªï¼Ÿ

~~å¿«é€Ÿå¹‚O(logn)é€’æ¨O(n)ä½ è¯´å¿«åœ¨å“ªï¼Ÿ~~

# ä¸€äº›éœ€è¦æ³¨æ„çš„åœ°æ–¹

ï¼ˆæ„Ÿè°¢xht37å¸®æˆ‘Debug...ï¼‰

- åœ¨**å¯ä»¥**æ¨¡~~è†œ~~çš„åœ°æ–¹éƒ½æ¨¡ä¸€ä¸‹ï¼Œå¯ä»¥é˜²æ­¢çˆ†ç²¾åº¦~~æ¶¨rp~~ã€‚
- **æ¬§æ‹‰å®šç†**ä¸èƒ½è¿ç”¨åœ¨çŸ©é˜µå¿«é€Ÿå¹‚ä¸­ï¼Œæ¨¡æ•°æ˜¯è´¨æ•°ä¹Ÿä¸è¡Œï¼ˆç”¨åœ¨æ™®é€šå¿«é€Ÿå¹‚ä¸­ä¹Ÿæ²¡è§‰å¾—å¿«å¤šå°‘ï¼Ÿ
- æ•°æ®ç±»å‹ä¸€å®šè¦ä¸€è‡´~~ä¸ç„¶ä¼šçˆ†é›¶~~

å·®ä¸å¤šå°±è¿™äº›äº†ã€‚